<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy Birthday Vartika ðŸŽ€</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;600;800&display=swap" rel="stylesheet">
  <!-- Three.js -->
  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>

  <style>
    :root{
      --bg:#fff7fb; --accent:#ff9fc1; --soft:#fbe7f0; --text:#2b2b2b;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:"Nunito",system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,var(--bg),#fff);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px;}
    .card{width:100%;max-width:1100px;height:720px;border-radius:18px;box-shadow:0 12px 40px rgba(0,0,0,0.09);overflow:hidden;display:grid;grid-template-columns:380px 1fr;background:linear-gradient(180deg,rgba(255,255,255,0.95),#fff)}
    .panel{padding:26px;background:linear-gradient(180deg,#fff,#fff)}
    .brand{font-weight:800;font-size:20px;margin-bottom:6px}
    .desc{font-size:14px;color:#666;margin-bottom:14px}
    .controls{display:flex;gap:8px;margin-bottom:12px}
    .btn{padding:10px 12px;border-radius:10px;border:0;cursor:pointer;background:#fff;box-shadow:0 6px 14px rgba(0,0,0,0.06);font-weight:700}
    .btn.primary{background:linear-gradient(90deg,#ffd1e0,#ffc0d1);color:#3b0b2a}
    .input{padding:10px;border-radius:10px;border:1px solid #eee;width:100%}
    .message{margin-top:18px;background:linear-gradient(180deg,#fff,#fff);padding:18px;border-radius:12px;min-height:150px;display:flex;flex-direction:column;justify-content:center;gap:8px}
    .to{font-size:16px;font-weight:800}
    .typewriter{font-size:18px;font-weight:700;letter-spacing:0.4px;color:#8a2b5f}
    .visual{position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:0}
    .pastel{width:100%;height:100%;position:relative;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px}
    .balloon{position:absolute;bottom:-120px;width:80px;height:110px;border-radius:50% 50% 48% 48%;transform-origin:center bottom;animation:floatUp linear infinite;opacity:0.97}
    .balloon::after{content:"";width:2px;height:60px;background:rgba(0,0,0,0.08);transform:translateY(10px)}
    @keyframes floatUp {0%{transform:translateY(0) rotate(-4deg)}50%{transform:translateY(-30vh) rotate(6deg)}100%{transform:translateY(-60vh) rotate(-4deg)}}
    .heart{width:42px;height:42px;position:absolute;transform:translateY(20px) scale(0.8);animation:pop 3s infinite ease-in-out;opacity:0.95}
    @keyframes pop {0%{transform:translateY(0) scale(.6);opacity:0}30%{transform:translateY(-40vh) scale(1.05);opacity:1}100%{transform:translateY(-80vh) scale(.4);opacity:0}}
    canvas#confetti, canvas#fireworks{position:absolute;inset:0;pointer-events:none}
    #three-container{width:100%;height:100%;display:none}
    .footer{margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .small{font-size:13px;color:#666}
    .overlayStart{position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,0.85),rgba(255,255,255,0.7));display:flex;align-items:center;justify-content:center;flex-direction:column;gap:12px;z-index:50}
    .overlayStart button{padding:12px 18px;border-radius:12px;border:0;font-weight:800;cursor:pointer}
    @media(max-width:900px){.card{grid-template-columns:1fr;height:100vh}.panel{order:2}.visual{order:1;height:60vh}}
  </style>
</head>
<body>

  <div class="card" id="card">
    <div class="panel">
      <div class="brand">birthday magic â€” for Vartika</div>
      <div class="desc">Auto-play animations when recipient opens the link. Click "Play Music" if audio blocked by browser.</div>

      <div class="controls" id="styleButtons">
        <button class="btn primary" data-style="pastel">Cute Pastel ðŸŽ€</button>
        <button class="btn" data-style="party">Party ðŸŽ‰</button>
        <button class="btn" data-style="cake3d">3D Cake ðŸŽ‚</button>
      </div>

      <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
        <input id="toName" class="input" value="Vartika" />
        <button class="btn" id="applyBtn">Apply</button>
      </div>

      <div class="message">
        <div class="to">To: <span id="toPreview">Vartika</span></div>
        <div class="typewriter" id="typewriter">Wishing you a day filled with love, laughter, and all the things you love most.</div>

        <div class="footer">
          <button class="btn primary" id="surpriseBtn">Surprise âœ¨</button>
          <button class="btn" id="musicToggle">Play Music</button>
          <div class="small">Tip: If music doesn't autoplay, press Play.</div>
        </div>
      </div>

      <div class="small" style="margin-top:10px">Customize message or replace music inside the file.</div>
    </div>

    <div class="visual" id="visualArea">
      <div class="pastel" id="pastel">
        <div style="z-index:5;text-align:center">
          <h1 style="margin:0;font-size:40px;color:#6a2a4d">Happy Birthday Vartika ðŸŽ€</h1>
          <p style="margin-top:8px;color:#7a5a6a">Wishing you a day filled with love, laughter, and all the things you love most.</p>
        </div>
      </div>

      <canvas id="confetti"></canvas>
      <canvas id="fireworks"></canvas>
      <div id="three-container"></div>

      <!-- Start overlay to get user's click (important for autoplay music) -->
      <div class="overlayStart" id="startOverlay" style="display:flex">
        <h2 style="margin:0">Open for Vartika ðŸŽ‰</h2>
        <p style="margin:0">Click to start the surprise</p>
        <button id="startBtn" style="background:linear-gradient(90deg,#ffd1e0,#ffc0d1)">Open Surprise</button>
      </div>
    </div>
  </div>

  <!-- background music (change if you want) -->
  <audio id="bgAudio" loop src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8a1b0c3ef7.mp3?filename=happy-upbeat-111204.mp3"></audio>

<script>
  // Elements
  const styleButtons = document.querySelectorAll('[data-style]');
  const pastel = document.getElementById('pastel');
  const confettiCanvas = document.getElementById('confetti');
  const fireworksCanvas = document.getElementById('fireworks');
  const threeContainer = document.getElementById('three-container');
  const visualArea = document.getElementById('visualArea');
  const toName = document.getElementById('toName');
  const toPreview = document.getElementById('toPreview');
  const applyBtn = document.getElementById('applyBtn');
  const typewriterEl = document.getElementById('typewriter');
  const surpriseBtn = document.getElementById('surpriseBtn');
  const musicToggle = document.getElementById('musicToggle');
  const audio = document.getElementById('bgAudio');
  const startOverlay = document.getElementById('startOverlay');
  const startBtn = document.getElementById('startBtn');

  let currentStyle = 'pastel';
  let confettiInstance=null, fireworksInstance=null, threeScene=null;

  applyBtn.onclick = ()=> {
    const name = toName.value.trim() || 'Your Friend';
    toPreview.textContent = name;
    typeWriter(`Wishing you a day filled with love, laughter, and all the things you love most.`, typewriterEl, 30);
  };

  styleButtons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      document.querySelectorAll('.btn').forEach(b=>b.classList.remove('primary'));
      btn.classList.add('primary');
      setStyle(btn.dataset.style);
    });
  });

  function setStyle(style){
    currentStyle = style;
    confettiCanvas.style.display='none'; fireworksCanvas.style.display='none'; pastel.style.display='none'; threeContainer.style.display='none';
    stopConfetti(); stopFireworks(); stopThree();
    if(style==='pastel'){ pastel.style.display='flex'; startPastel(); }
    else if(style==='party'){ confettiCanvas.style.display='block'; fireworksCanvas.style.display='block'; startConfetti(); startFireworks(); }
    else if(style==='cake3d'){ threeContainer.style.display='block'; startThree(); }
  }

  // default
  document.querySelector('[data-style="pastel"]').click();

  function typeWriter(text, el, speed=60){
    el.textContent=''; let i=0;
    const id = setInterval(()=>{ el.textContent += text.charAt(i); i++; if(i>=text.length) clearInterval(id); }, speed);
  }

  // Pastel balloons/hearts
  function startPastel(){
    pastel.innerHTML='';
    const txt = document.createElement('div');
    txt.style.zIndex=6; txt.style.textAlign='center';
    txt.innerHTML = `<h1 style="margin:0;font-size:40px;color:#6a2a4d">Happy Birthday ${toPreview.textContent} ðŸŽ€</h1><p style="margin-top:8px;color:#7a5a6a">Wishing you a day filled with love, laughter, and all the things you love most.</p>`;
    pastel.appendChild(txt);
    const colors = ['#ffd1e0','#ffecd8','#cde7ff','#d3f8e2','#ffd9f1'];
    for(let i=0;i<6;i++){
      const b=document.createElement('div'); b.className='balloon';
      const size=60+Math.floor(Math.random()*40);
      b.style.width=size+'px'; b.style.height=Math.floor(size*1.35)+'px';
      b.style.left=(5+Math.random()*85)+'%'; b.style.background=colors[Math.floor(Math.random()*colors.length)];
      b.style.animationDuration=(8+Math.random()*8)+'s'; b.style.zIndex=4; pastel.appendChild(b);
    }
    for(let i=0;i<8;i++){
      const h=document.createElement('div'); h.className='heart';
      h.style.left=(5+Math.random()*90)+'%'; h.style.bottom='10px'; h.style.animationDelay=(Math.random()*3)+'s';
      h.style.width=(20+Math.random()*40)+'px'; h.style.height=h.style.width;
      h.innerHTML=`<svg viewBox="0 0 32 29.6" style="width:100%;height:100%"><path fill="#ff8fb3" d="M23.6,0c-2.9,0-5.4,1.6-6.6,4C15.8,1.6,13.3,0,10.4,0C4.7,0,0,4.7,0,10.4c0,6.5,8.9,10.9,16,18.1 c7.1-7.1,16-11.6,16-18.1C32,4.7,27.3,0,23.6,0z"/></svg>`;
      pastel.appendChild(h);
    }
  }

  // Confetti
  function startConfetti(){
    const canvas=confettiCanvas; const ctx=canvas.getContext('2d');
    canvas.width = visualArea.clientWidth; canvas.height = visualArea.clientHeight;
    let particles=[];
    function spawn(){ const w = canvas.width; for(let i=0;i<140;i++){ particles.push({ x:Math.random()*w, y:-10-Math.random()*300, vx:(Math.random()-0.5)*4, vy:1+Math.random()*4, size:6+Math.random()*12, color:['#ff4da6','#ffd166','#8ecae6','#c6f6d5','#f6c1ff'][Math.floor(Math.random()*5)], rot:Math.random()*360, rotSpeed:(Math.random()-0.5)*12 }); } }
    spawn();
    confettiInstance = { running:true, frame:function(){ ctx.clearRect(0,0,canvas.width,canvas.height); for(let i=0;i<particles.length;i++){ const p=particles[i]; p.x+=p.vx; p.y+=p.vy; p.vy += 0.02; p.rot += p.rotSpeed; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180); ctx.fillStyle=p.color; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6); ctx.restore(); if(p.y>canvas.height+80){ p.y=-20; p.x=Math.random()*canvas.width; p.vx=(Math.random()-0.5)*4; p.vy=1+Math.random()*4; } } if(confettiInstance.running) requestAnimationFrame(confettiInstance.frame); } };
    confettiInstance.frame(); setInterval(()=>{ if(confettiInstance) spawn(); }, 3000);
  }
  function stopConfetti(){ if(confettiInstance){ confettiInstance.running=false; confettiInstance=null; confettiCanvas.getContext('2d').clearRect(0,0,confettiCanvas.width,confettiCanvas.height); } }

  // Fireworks
  function startFireworks(){
    const canvas = fireworksCanvas; const ctx = canvas.getContext('2d');
    canvas.width = visualArea.clientWidth; canvas.height = visualArea.clientHeight;
    let rockets = [], particles = [];
    function launch(){ rockets.push({ x:Math.random()*canvas.width, y:canvas.height+10, vx:(Math.random()-0.5)*2, vy:-6-Math.random()*3, explodeAt:Math.random()*(canvas.height*0.6)+canvas.height*0.2, color:['#ff6b6b','#ffd166','#9be15d','#8ec5ff'][Math.floor(Math.random()*4)] }); }
    function explode(rock){ const count = 30 + Math.floor(Math.random()*40); for(let i=0;i<count;i++){ const angle = Math.random()*Math.PI*2; const speed = 1 + Math.random()*5; particles.push({ x:rock.x,y:rock.y,vx:Math.cos(angle)*speed,vy:Math.sin(angle)*speed,life:60+Math.random()*40,color:rock.color,size:2+Math.random()*3 }); } }
    fireworksInstance = { running:true, frame:function(){ ctx.fillStyle='rgba(0,0,0,0.08)'; ctx.fillRect(0,0,canvas.width,canvas.height); for(let i=rockets.length-1;i>=0;i--){ const r=rockets[i]; r.x+=r.vx; r.y+=r.vy; r.vy+=0.06; ctx.beginPath(); ctx.arc(r.x,r.y,3,0,Math.PI*2); ctx.fillStyle=r.color; ctx.fill(); if(r.vy >= 0 || r.y < r.explodeAt){ explode(r); rockets.splice(i,1); } } for(let i=particles.length-1;i>=0;i--){ const p=particles[i]; p.x+=p.vx; p.y+=p.vy; p.vy+=0.06; p.life--; ctx.globalAlpha = Math.max(0, p.life/80); ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fillStyle=p.color; ctx.fill(); ctx.globalAlpha = 1; if(p.life <= 0) particles.splice(i,1); } if(fireworksInstance.running) requestAnimationFrame(fireworksInstance.frame); } };
    fireworksInstance.frame(); fireworksInstance._interval = setInterval(()=>{ if(fireworksInstance) launch(); }, 900);
  }
  function stopFireworks(){ if(fireworksInstance){ fireworksInstance.running=false; clearInterval(fireworksInstance._interval); fireworksInstance=null; fireworksCanvas.getContext('2d').clearRect(0,0,fireworksCanvas.width,fireworksCanvas.height);} }

  // Three.js cake
  function startThree(){
    const container = threeContainer; const width = container.clientWidth || visualArea.clientWidth; const height = container.clientHeight || visualArea.clientHeight;
    const scene = new THREE.Scene(); const camera = new THREE.PerspectiveCamera(45, width/height, 0.1, 1000); camera.position.set(0,3,8);
    const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true}); renderer.setSize(width,height);
    container.innerHTML=''; container.appendChild(renderer.domElement);
    const hemi = new THREE.HemisphereLight(0xffffff,0x444444,1.1); scene.add(hemi);
    const dir = new THREE.DirectionalLight(0xffffff,0.8); dir.position.set(5,10,7); scene.add(dir);
    const layers = [{r:2.2,h:0.9,color:0xffe1f0},{r:1.6,h:0.8,color:0xffc8e1},{r:1.0,h:0.7,color:0xff9fc1}];
    let y = - (layers.reduce((s,l)=>s+l.h,0)/2) + layers[0].h/2; const cake = new THREE.Group();
    layers.forEach((l,idx)=>{ const geo = new THREE.CylinderGeometry(l.r,l.r,l.h,48); const mat = new THREE.MeshStandardMaterial({color:l.color, roughness:0.7}); const mesh = new THREE.Mesh(geo,mat); mesh.position.y=y; if(idx===layers.length-1){ const dripGeo = new THREE.TorusGeometry(0.85,0.18,16,100); const drip = new THREE.Mesh(dripGeo, new THREE.MeshStandardMaterial({color:0xfff3fd, roughness:0.6})); drip.rotation.x=Math.PI/2; drip.position.y=y + l.h/2 + 0.02; cake.add(drip);} cake.add(mesh); y += l.h; });
    const candleGroup = new THREE.Group(); const candleCount=5;
    for(let i=0;i<candleCount;i++){ const angle=(i/candleCount)*Math.PI*2; const x=Math.cos(angle)*0.6; const z=Math.sin(angle)*0.6; const cyl = new THREE.CylinderGeometry(0.05,0.05,0.6,12); const mat = new THREE.MeshStandardMaterial({color:0xffffff}); const candle = new THREE.Mesh(cyl,mat); candle.position.set(x,1.3,z); const flameMat = new THREE.MeshStandardMaterial({color:0xffa551, emissive:0xff8a1f, emissiveIntensity:1}); const flameGeo = new THREE.SphereGeometry(0.07,8,8); const flame = new THREE.Mesh(flameGeo, flameMat); flame.position.set(x,1.6,z); candleGroup.add(candle); candleGroup.add(flame); }
    cake.add(candleGroup); scene.add(cake);
    const ground = new THREE.Mesh(new THREE.PlaneGeometry(30,30), new THREE.MeshStandardMaterial({color:0xffffff})); ground.rotation.x = -Math.PI/2; ground.position.y = -2; scene.add(ground);
    function animate(){ cake.rotation.y += 0.005; candleGroup.rotation.y += 0.006; renderer.render(scene,camera); threeScene._raf = requestAnimationFrame(animate); }
    threeScene = { scene, camera, renderer, container, running:true, _raf:null, cleanup:function(){ cancelAnimationFrame(this._raf); container.innerHTML=''; } };
    animate();
  }
  function stopThree(){ if(threeScene){ threeScene.cleanup(); threeScene=null; } }

  // Surprise button
  surpriseBtn.addEventListener('click', ()=>{
    if(currentStyle==='pastel'){ setStyle('party'); setTimeout(()=> setStyle('pastel'),5000); }
    else if(currentStyle==='party'){ /* extra bursts are automatic */ }
    else if(currentStyle==='cake3d'){ if(threeScene){ let ticks=0; const fast = ()=>{ if(!threeScene) return; threeScene.scene.traverse(obj=>{ if(obj.type==='Group' && obj.rotation) obj.rotation.y += 0.25; }); ticks++; if(ticks>8) return; requestAnimationFrame(fast); }; fast(); } }
  });

  // Music toggle
  musicToggle.addEventListener('click', ()=>{
    if(audio.paused){ audio.play().catch(()=>{ alert('Autoplay blocked â€” press Open Surprise or Play Music.'); }); musicToggle.textContent='Pause Music'; }
    else { audio.pause(); musicToggle.textContent='Play Music'; }
  });

  // Start overlay click â€” this gives user gesture so audio can play and animations auto-start
  startBtn.addEventListener('click', ()=>{
    startOverlay.style.display='none';
    // play audio if user allowed
    audio.play().catch(()=>{ /* ignore */ });
    // start default style (and small party flash)
    setStyle('pastel');
    // show a quick confetti+fireworks for greeting
    setStyle('party');
    setTimeout(()=> setStyle('pastel'), 4500);
  });

  // Resize handlers
  window.addEventListener('resize', ()=>{
    confettiCanvas.width = visualArea.clientWidth; confettiCanvas.height = visualArea.clientHeight;
    fireworksCanvas.width = visualArea.clientWidth; fireworksCanvas.height = visualArea.clientHeight;
    if(threeScene){ const w = threeContainer.clientWidth || visualArea.clientWidth; const h = threeContainer.clientHeight || visualArea.clientHeight; threeScene.renderer.setSize(w,h); threeScene.camera.aspect = w/h; threeScene.camera.updateProjectionMatrix(); }
  });

  // initial typewriter
  function typeWriterInit(){ typeWriter('Wishing you a day filled with love, laughter, and all the things you love most.', typewriterEl, 30); }
  typeWriterInit();

  // initial canvas sizing (for safety)
  setTimeout(()=>{ confettiCanvas.width = visualArea.clientWidth; confettiCanvas.height = visualArea.clientHeight; fireworksCanvas.width = visualArea.clientWidth; fireworksCanvas.height = visualArea.clientHeight; }, 200);

  // Helper: basic typeWriter
  function typeWriter(text, el, speed=60){ el.textContent=''; let i=0; const id=setInterval(()=>{ el.textContent += text.charAt(i); i++; if(i>=text.length) clearInterval(id); }, speed); }

</script>
</body>
</html>
